---
layout: post
title:  "ì¶”ì²œì‹œìŠ¤í…œ ê³µë¶€ (1) - ì „ë°˜ì ì¸ ë‚´ìš©"
date:   2021-04-07
categories: ["2021","AI"]
update: 2021-04-07
tags: [AI,Recommendation]
---

ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ì„ ìž…ë¬¸í•˜ë ¤ê³  í•˜ëŠ” ì €ì—ê²Œ ì¹œêµ¬ê°€ ë³´ë©´ ì¢‹ë‹¤ê³  ì†Œê°œí•´ì¤€ ê¸€ + ì¶”ê°€ë¡œ ì°¾ì•„ë³¸ ê¸€ì„ ì •ë¦¬í•´ ë³´ê² ìŠµë‹ˆë‹¤.

### Intro 

![image](https://user-images.githubusercontent.com/51329156/100213332-d35ee480-2f51-11eb-9d0b-20b17ed189d8.png)

ì¶”ì²œ ì‹œìŠ¤í…œì„ ê³µë¶€í•˜ëŠ” ë°°ê²½ì—ëŠ”, ì„¸ìƒì€ ì—°ê²°ë˜ì–´ ìžˆë‹¤ëŠ” ì‚¬ì‹¤ì´ ìžˆìŠµë‹ˆë‹¤. ì„¸ìƒì€ ì €í¬ê°€ ìƒê°í•˜ëŠ” ê²ƒë³´ë‹¤ë„ í›¨ì”¬ ë” ë°€ì ‘í•˜ê²Œ ì—°ê²°ë˜ì–´ ìžˆìŠµë‹ˆë‹¤.  ìœ„ ê·¸ë¦¼ì—ì„œ í™•ì¸í•  ìˆ˜ ìžˆë“¯ì´ ì‚¬ìš©ìžì™€ ì‚¬ìš©ìžê°„ì˜ ì—°ê²°ì´ ìžˆê³ , ì‚¬ìš©ìžì™€ ì•„ì´í…œê°„ì˜ ì—°ê²°ì´ ìžˆìŠµë‹ˆë‹¤. `u1`ê³¼ `u2`ëŠ” sns ìƒ ì¹œêµ¬ì´ê³ , ë‘ ì‚¬ìš©ìžëŠ” ë‘˜ë‹¤ i1(`Shape of You`)ë¥¼ ì¢‹ì•„í•©ë‹ˆë‹¤. ì´ ë¿ë§Œì´ ì•„ë‹ˆë¼ ì•„ì´í…œê³¼ ì•„ì´í…œ ì‚¬ì´ì—ë„ ê°™ì€ ê°€ìˆ˜, ê°™ì€ ìž¥ë¥´ì¸ì§€ì— ë”°ë¼ ì—°ê²°ì´ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤. 

ì¶”ì²œ ì‹œìŠ¤í…œì„ í¬ê²Œ ë‚˜ëˆ„ìžë©´ ë‘ ê°€ì§€ê°€ ìžˆìŠµë‹ˆë‹¤.

- **Content-based filtering** : ì‚¬ìš©ìžë‚˜ ì•„ì´í…œì„ ëª‡ ê°€ì§€ íŠ¹ì§•(ì´ë¦„, ì œëª©, ìž¥ë¥´, ..)ìœ¼ë¡œ í‘œí˜„í•˜ê³  ê°™ì€ íŠ¹ì§•ì„ ê°€ì§„ ë‹¤ë¥¸ ì•„ì´í…œì„ ì¶”ì²œí•˜ëŠ” ë°©ì‹ìž…ë‹ˆë‹¤. **Collaborative filtering**ì€ ì‚¬ìš©ìžì™€ ì•„ì´í…œê°„ì˜ ìƒí˜¸ìž‘ìš©ì„ ë¶„ì„í•˜ëŠ” ë°©ë²•ì¸ ë°˜ë©´ ì´ ë°©ë²•ì€ ì•„ì´í…œ ìžì²´ë¼ë¦¬ ë¹„ìŠ·í•œì§€ ë¹„êµí•˜ëŠ” ë°©ë²•ìž…ë‹ˆë‹¤. ì•„ì´í…œì„ í•˜ë‚˜ì˜ ë²¡í„°ë¡œ í‘œí˜„í•œ ë‹¤ìŒ, clustering ì•Œê³ ë¦¬ì¦˜ì„ í†µí•´ ì•„ì´í…œì„ ì—¬ëŸ¬ clusterë¡œ ë‚˜ëˆ•ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì‚¬ìš©ìžê°€ ì„ íƒí•œ ì•„ì´í…œê³¼ ê°™ì€ clusterì— ìžˆëŠ” ë‹¤ë¥¸ ì•„ì´í…œì„ ì¶”ì²œí•˜ëŠ” ë°©ì‹ìž…ë‹ˆë‹¤. ì´ ë°©ì‹ì€ ê³¼ê±°ì— ì‚¬ìš©ìžê°€ ì„ íƒí–ˆë˜ ì•„ì´í…œì„ ê¸°ë°˜ìœ¼ë¡œ ì¶”ì²œí•´ì£¼ê¸° ë•Œë¬¸ì— í•œê³„ê°€ ë§ŽìŠµë‹ˆë‹¤.
- **Collaborative filtering** : ì‚¬ìš©ìžì™€ ì•„ì´í…œ ê°„ì˜ ìƒí˜¸ìž‘ìš© ì •ë³´ë¥¼ í†µí•´ ì‚¬ìš©ìžê°€ ì¢‹ì•„í•  ë§Œí•œ ì•„ì´í…œì„ ì¶”ì²œí•©ë‹ˆë‹¤. ê¸°ë³¸ì ì¸ ê°œë…ì€ ì‚¬ìš©ìž-ì•„ì´í…œ ìƒí˜¸ìž‘ìš© ì •ë³´ë¥¼ í†µí•´ ë¹„ìŠ·í•œ ì‚¬ìš©ìž or ë¹„ìŠ·í•œ ì•„ì´í…œë“¤ì„ ì°¾ì•„ë‚´ì„œ ì„ í˜¸í•  ë§Œí•œ ì•„ì´í…œì„ ì¶”ì²œí•˜ëŠ” ë°©ì‹ìž…ë‹ˆë‹¤. **Content-based filtering**ê³¼ëŠ” ë‹¤ë¥´ê²Œ ì‚¬ìš©ìžë‚˜ ì•„ì´í…œ ìžì²´ì˜ íŠ¹ì„±ì„ ì¶”ì²œì— ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ ê¸€ì—ì„œëŠ” ì´ ë°©ë²•ì— ëŒ€í•´ ì£¼ë¡œ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.

### Overview of Recommendation Engine

![image](https://user-images.githubusercontent.com/51329156/100213911-9515f500-2f52-11eb-8cb3-3dfe16edfec8.png)

**User interest**, ì¦‰ ì‚¬ìš©ìžê°€ ì•„ì´í…œì— ë§¤ê¸°ëŠ” ì ìˆ˜ëŠ” ë³„ì ì„ ì£¼ëŠ” í–‰ìœ„ì™€ ê°™ì´ ì§ì ‘ì (Explicit)ìœ¼ë¡œ ë“œëŸ¬ë‚  ìˆ˜ë„ ìžˆì§€ë§Œ, ê°„ì ‘ì (Implicit)ì¸ ë°©ë²•ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ëŠ” ê²½ìš°ë„ ìžˆìŠµë‹ˆë‹¤. ì´ ë•Œê¹Œì§€ ì‚¬ìš©ìžê°€ ë‚¨ê¸´ ì¢‹ì•„ìš”ë“¤, ì›¹íŽ˜ì´ì§€ì— ë¨¸ë¬´ë¥¸ ì‹œê°„ ë“±ì€ ì§ì ‘ì ìœ¼ë¡œ ë“œëŸ¬ë‚˜ì§€ëŠ” ì•Šì§€ë§Œ ì‚¬ìš©ìžì˜ interestë¥¼ ë‚˜íƒ€ë‚¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ ë§í•˜ëŠ” ì•„ì´í…œì€ ì˜í™”, ì¹œêµ¬, ë‰´ìŠ¤ ë“±ë“±ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

ì—¬ê¸°ì„œ ë¬¸ì œëŠ”, **User**ì™€ **Item**ê°„ì— ì¡´ìž¬í•˜ëŠ” ì°¨ì´ë¥¼ ì–´ë–»ê²Œ í•´ê²°í•˜ëŠëƒ ìž…ë‹ˆë‹¤. ë‹¹ì—°í•˜ê²Œë„ ì‚¬ìš©ìžì™€ ì•„ì´í…œì€ ë‹¤ë¥¸ íƒ€ìž…ì˜ ê°œì²´ì´ê¸° ë•Œë¬¸ì— ì‚¬ìš©ìžëŠ” ì‚¬ìš©ìžì˜ íŠ¹ì„±ì— ì˜í•´ í‘œí˜„ë˜ê³ , ì•„ì´í…œì€ ì•„ì´í…œì˜ íŠ¹ì„±ì— ë§žê²Œ í‘œí˜„ë  ê²ƒìž…ë‹ˆë‹¤. ì´ëŸ¬í•œ ì°¨ì´ê°€ ìžˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³ , ì•„ì´í…œì— ëŒ€í•œ ì‚¬ìš©ìžì˜ **User interest**ë¥¼ êµ¬í•˜ëŠ” ê²Œ ì£¼ ëª©ì ì´ë¼ ë³´ì‹œë©´ ë©ë‹ˆë‹¤.

ì´ ë‚´ìš©ê³¼ ìœ„ ê·¸ë¦¼ì„  ê³µì‹í™”í•´ë´…ì‹œë‹¤. **Input**ì€ ì´ ë•Œê¹Œì§€ ì‚¬ìš©ìžê°€ ì•„ì´í…œë“¤ê³¼ í•´ì˜¨ interactionì˜ ê¸°ë¡ë“¤ê³¼ ì¶”ê°€ì ì¸ ì •ë³´ë“¤(ì‚¬ìš©ìžì˜ êµ­ì  ë“±)ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. **Output**ì—ëŠ” ì‚¬ìš©ìžê°€ ì•„ì´í…œì„ ì–¼ë§ˆë‚˜ ì¢‹ì•„í• ì§€ ì ìˆ˜ë¡œ ë‚˜íƒ€ë‚´ê³  ì ìˆ˜ê°€ ë†’ì€ TOP-N ì•„ì´í…œì´ ì˜¬ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. í˜¹ì€ ì‚¬ìš©ìžê°€ ì•„ì§ í‰ê°€í•˜ì§€ ì•Šì€ ì•„ì´í…œì— ëŒ€í•´ ì–´ë–»ê²Œ í‰ê°€í• ì§€ë¥¼ ì˜ˆì¸¡í•œ ê°’ì´ ì˜¬ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì¤€ìš©ì´ê°€ í…Œë„·ì„ ì–¼ë§ˆë‚˜ ì¢‹ì•„í•˜ëŠ”ì§€ ì˜ˆì¸¡í•  ë•Œ, **Input**ìœ¼ë¡œëŠ” ì´ ë•Œê¹Œì§€ ì‚¬ìš©ìžê°€ ë‹¤ë¥¸ ì•„ì´í…œë“¤ì— ë§¤ê¸´ ë³„ì ì„ ë„£ê³ , **Output**ì— ì¤€ìš©ì´ê°€ í…Œë„·ì— ë§¤ê¸¸ ê²ƒ ê°™ì€ ë³„ì ì„ ë‚´ ë†“ëŠ” ê²ƒìž…ë‹ˆë‹¤. 

### ì¶”ì²œ ì‹œìŠ¤í…œì´ í’€ê³ ìž í•˜ëŠ” ë¬¸ì œ

 **ëž­í‚¹ ë¬¸ì œ**

ì‚¬ìš©ìžê°€ ì•„ì´í…œì— ë‚¨ê¸¸ í‰ì (ì ìˆ˜)ë¥¼ ì •í™•í•˜ê²Œ ì˜ˆì¸¡í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. ëŒ€ì‹  íŠ¹ì • ì‚¬ìš©ìžê°€ ì¢‹ì•„í• ë§Œí•œ Top-N ì•„ì´í…œì„ ì„ ì •í•˜ê±°ë‚˜, íŠ¹ì • ì•„ì´í…œì„ ì¢‹ì•„í• ë§Œí•œ Top-N ì‚¬ìš©ìžë¥¼ ì„ ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì •í™•í•œ ì ìˆ˜ë³´ë‹¤ëŠ” ëŒ€ìƒê°„ì˜ ìˆœì„œê°€ ì¤‘ìš”í•œ ë¬¸ì œìž…ë‹ˆë‹¤.

**ì˜ˆì¸¡ ë¬¸ì œ**

ì‚¬ìš©ìž-ì•„ì´í…œ ì¡°í•©ì—ì„œ í‰ì (ì ìˆ˜)ë¥¼ ì •í™•ížˆ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤. ì‚¬ìš©ìž-ì•„ì´í…œ í–‰ë ¬ì„ ì±„ìš°ëŠ” ë¬¸ì œë¡œë„ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì‚¬ìš©ìž(m) x ì•„ì´í…œ(n) ì˜ m X n í–‰ë ¬ì—ì„œ ë¹„ì–´ìžˆëŠ” ë¶€ë¶„ì´ ì¡´ìž¬í•  ë•Œ, ê´€ì¸¡ê°’(ì±„ì›Œì ¸ìžˆëŠ” ê°’)ì€ ëª¨ë¸ í•™ìŠµì— ì‚¬ìš©í•˜ê³ , ê²°ì¸¡ê°’(ë¹„ì–´ìžˆëŠ” ê°’)ì€ ëª¨ë¸ í‰ê°€ì— ì‚¬ìš©í•©ë‹ˆë‹¤.

## í˜‘ì—… í•„í„°ë§(Collaborative Filtering)

**í˜‘ì—… í•„í„°ë§**ì€ **User interest**ë¥¼ ì˜ˆì¸¡í•  ë•Œ ë§Žì€ ì‚¬ìš©ìžë“¤ë¡œë¶€í„° ëª¨ì€ ì·¨í–¥ ì •ë³´ë“¤ì„ ì´ìš©í•´ ì˜ˆì¸¡í•˜ëŠ” ê¸°ìˆ ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ì„œ ì¤€ìš©ì´ì™€ ìŠ¹ìœ¤ì´ì˜ ì˜í™”ì·¨í–¥ì´ ë¹„ìŠ·í•  ë•Œ, ìŠ¹ìœ¤ì´ê°€ í…Œë„·ì„ ì¢‹ì•„í•  ê²ƒì¸ê°€? ì— ëŒ€í•´ì„œëŠ” **YES**ë¼ê³  íŒë‹¨í•©ë‹ˆë‹¤. (ì˜ˆì œëŠ” ìœ„ì™€ ì´ì–´ì§‘ë‹ˆë‹¤). ì¦‰ ë¹„ìŠ·í•œ ì‚¬ìš©ìžë“¤ì€ ì•„ë§ˆë„ ë¹„ìŠ·í•œ ì·¨í–¥ì„ ê°€ì§€ê³  ìžˆì„ ê²ƒì´ë¼ê³  ì˜ˆì¸¡í•©ë‹ˆë‹¤. 

**í˜‘ì—… í•„í„°ë§**ì˜ ì¢…ë¥˜ì—ëŠ” Memory-based CF, Model-based CF, Hybridê°€ ìžˆìŠµë‹ˆë‹¤. 

- **memory-based** : ë°ì´í„°ë¡œ ì£¼ì–´ì§€ëŠ” ì‚¬ìš©ìž-ì•„ì´í…œ ìƒí˜¸ìž‘ìš© í–‰ë ¬ì„ ê·¸ëŒ€ë¡œ ë‹¤ í™œìš©í•´ì„œ ì‚¬ìš©ìžì˜ ratingì„ ì˜ˆì¸¡í•˜ëŠ” ë°©ë²•ìž…ë‹ˆë‹¤.
- **model-based** : ì‚¬ìš©ìž-ì•„ì´í…œ ìƒí˜¸ìž‘ìš© í–‰ë ¬ì„ í†µí•´ modelì„ í•™ìŠµì‹œí‚¤ê³  ì´ ëª¨ë¸ì„ ê°€ì§€ê³  ratingì„ ì˜ˆì¸¡í•˜ëŠ” ë°©ë²•ìž…ë‹ˆë‹¤. 

### Memory-based CF

![image](https://user-images.githubusercontent.com/51329156/100218541-381d3d80-2f58-11eb-8d71-438e9ed9112f.png)

ìœ„ ê·¸ë¦¼ì—ì„œ ë³´ë©´ u1ëŠ” i1ì— ëŒ€í•´ ë³„ì  5ì ì„ ë‚¨ê²¼ê³ , ë‹¤ë¥¸ ì•„ì´í…œë“¤ì— ëŒ€í•´ì„œëŠ” ë³„ì ì„ ë‚¨ê¸°ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í˜„ì‹¤ì—ì„œ ì‹¤ì œë¡œ ì‚¬ìš©ìžë“¤ì´ ëª¨ë“  ì•„ì´í…œì— ë³„ì ì„ ë‚¨ê¸°ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤. 

ì—¬ê¸°ì„œ ì €í¬ê°€ í•´ê²°í•´ì•¼ í•˜ëŠ” ë¬¸ì œê°€ ë¹¨ê°„ìƒ‰ í‘œì‹œê°€ ëœ ë¶€ë¶„(u1ì˜ i4ì— ëŒ€í•œ í‰ê°€)ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì´ë¼ê³  í•´ë´…ì‹œë‹¤. **Memory-based CF**ëŠ” ìœ ì‚¬ë„ë¥¼ ê¸°ë°˜í•˜ì—¬ ë™ìž‘í•©ë‹ˆë‹¤. ì´ ë•Œ ë§í•˜ëŠ” ìœ ì‚¬ë„ëŠ” ì‚¬ìš©ìžì™€ ì‚¬ìš©ìžê°„ì˜ ìœ ì‚¬ë„ê°€ ë  ìˆ˜ë„ ìžˆê³ , ì•„ì´í…œê³¼ ì•„ì´í…œê°„ì˜ ìœ ì‚¬ë„ê°€ ë  ìˆ˜ë„ ìžˆìŠµë‹ˆë‹¤. ì‚¬ìš©ìž ì‚¬ì´ì˜ ìœ ì‚¬ë„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•˜ëŠ” ê²½ìš°ëŠ” **User-based**, ì•„ì´í…œ ì‚¬ì´ì˜ ìœ ì‚¬ë„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•˜ëŠ” ê²½ìš°ëŠ” **Item-based**ì´ë¼ê³  í•©ë‹ˆë‹¤.

|      | í…Œë„· | ì¸í„°ìŠ¤í…”ë¼ | ê²¨ìš¸ì™•êµ­ | ì–´ë°”ì›ƒ íƒ€ì›€ |
| ---- | ---- | ---------- | -------- | ----------- |
| ì¤€ìš© | 5    | 4          | ?        | 2           |
| ìŠ¹ìœ¤ | ?    | 4          | 1        | 5           |
| ë™ìš± | 1    | ?          | 5        | ?           |
| ì„œì—° | ?    | ?          | 3        | 4           |
| ë¬´ì—´ | 5    | 3          | 3        | ?           |

**ì‚¬ìš©ìž ê¸°ë°˜ (User-Based)**

ì‚¬ìš©ìž ê¸°ë°˜ì—ì„œëŠ” í•œ ì‚¬ìš©ìžê°€ í‰ê°€í•œ ì˜í™”ë“¤ì˜ í‰ì ë“¤ì„ ê°€ì§€ê³  ë²¡í„°ë¡œ í‘œí˜„í•©ë‹ˆë‹¤. ìœ„ì˜ í‘œë¥¼ ë³´ë©´ ì¤€ìš©ì˜ í‰ê°€ ë²¡í„°ëŠ” `(5,4,-,2)`ì´ê³  ìŠ¹ìœ¤ì˜ í‰ê°€ ë²¡í„°ëŠ” `(-,4,1,5)`ìž…ë‹ˆë‹¤. ì´ ë•Œ ë‘ ì‚¬ìš©ìžê°„ ìœ ì‚¬ë„ëŠ” ë‘ ë²¡í„° ê°„ ìœ ì‚¬ë„ë¡œ ì •ì˜í•©ë‹ˆë‹¤. ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤ :

![image](https://user-images.githubusercontent.com/51329156/100496370-f62e0a80-3196-11eb-87d2-526179d9084d.png)

ìœ ì‚¬ë„ë¥¼ êµ¬í•˜ëŠ” ë°©ë²•ì—ëŠ” ì—¬ëŸ¬ê°€ì§€ê°€ ìžˆì§€ë§Œ ì´ë²ˆì—ëŠ” ê°„ë‹¨í•œ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë¥¼ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.

ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë¥¼ ì´ìš©í•´ ì‚¬ìš©ìž ê°„ ìœ ì‚¬ë„ë¥¼ êµ¬í•  ë•ŒëŠ” ë‘ ì‚¬ìš©ìžê°€ ê³µí†µìœ¼ë¡œ í‰ê°€í•œ í•­ëª©ì— ëŒ€í•´ì„œë§Œ ê³„ì‚°í•©ë‹ˆë‹¤. ì¦‰ ì¤€ìš©ê³¼ ìŠ¹ìœ¤ì˜ ìœ ì‚¬ë„ë¥¼ ê³„ì‚°í•  ë•Œ `A=(4,2)`,`B=(4,5)`ì´ê³  ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë¥¼ êµ¬í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤ :

![image](https://user-images.githubusercontent.com/51329156/100496381-0cd46180-3197-11eb-89d2-c6153d8d7a0e.png)

ì´ëŸ° ì‹ìœ¼ë¡œ ëª¨ë“  ì‚¬ìš©ìž ê°„ì˜ ìœ ì‚¬ë„ë¥¼ êµ¬í•˜ë©´ ì‚¬ìš©ìž ìˆ˜ * ì‚¬ìš©ìž ìˆ˜(5*5) í¬ê¸°ì˜ ìœ ì‚¬ë„ í–‰ë ¬ì„ ë§Œë“¤ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ë§Œì•½ ë™ìš±ì´ ì¸í„°ìŠ¤í…”ë¼ì— ë‚¨ê¸´ í‰ì ì„ êµ¬í•˜ê³  ì‹¶ìœ¼ë©´ ìœ ì‚¬í•œ ëª‡ëª…ì˜ ì ìˆ˜ë¥¼ ì´ìš©í•´ êµ¬í•˜ê±°ë‚˜ ì „ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ weight sum ê°’ì„  ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì „ìžë¥¼ ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤ : 

![image](https://user-images.githubusercontent.com/51329156/100496388-165dc980-3197-11eb-9533-5ebc52746bad.png)

ìœ„ì˜ ìˆ˜ì‹ì€ ìœ ì‚¬í•œ ì‚¬ìš©ìžë“¤ì„ êµ¬í•´ (ê·¸ ì‚¬ìš©ìžì™€ì˜ ìœ ì‚¬ë„ * ê·¸ ì‚¬ìš©ìžì˜ ì˜ˆì¸¡ê°’)ë“¤ì˜ í•©ì„ ì˜ˆì¸¡ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. í›„ìžì˜ ê²½ìš°ì¸ ì „ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ weight sum ê°’ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì˜ ìˆ˜ì‹ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤ :

![image](https://user-images.githubusercontent.com/51329156/100496394-22e22200-3197-11eb-859d-3234d0c01b1d.png)

**ì•„ì´í…œ ê¸°ë°˜ (item-Based)**

ì•„ì´í…œ ê¸°ë°˜ì€  ì•„ì´í…œì— ëŒ€í•´ ì‚¬ìš©ìžë“¤ì´ ì–´ë–¤ ì‹ìœ¼ë¡œ í‰ê°€í–ˆëŠ”ì§€ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìœ ì‚¬ë„ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.  ìœ„ì˜ í–‰ë ¬ì„ ì°¸ê³ í•´ì„œ í…Œë„·ê³¼ ì¸í„°ìŠ¤í…”ë¼ì˜ ìœ ì‚¬ë„ë¥¼ êµ¬í•´ë´…ì‹œë‹¤. í…Œë„·ê³¼ ì¸í„°ìŠ¤í…”ë¼ ëª¨ë‘ë¥¼ í‰ê°€í•œ ì‚¬ìš©ìžëŠ” ì¤€ìš©, ë¬´ì—´ì´ê³  ê°ê°ì„ ë²¡í„°ë¡œ ë‚˜íƒ€ë‚´ë©´ `(5,4)`,`(5,3)` ìž…ë‹ˆë‹¤ :

![image](https://user-images.githubusercontent.com/51329156/100496399-32616b00-3197-11eb-8d2b-bf6ee652b039.png)

í…Œë„·ê³¼ ì¸í„°ìŠ¤í…”ë¼ì˜ ìœ ì‚¬ë„ëŠ” 0.99ë¡œ ìƒë‹¹ížŒ ë†’ì€ ìœ ì‚¬ë„ ìž…ë‹ˆë‹¤. ì¦‰ í…Œë„·ì„ ì¢‹ì•„í•˜ëŠ” ì‚¬ëžŒì€ ì¸í„°ìŠ¤í…”ë¼ë¥¼ ì¢‹ì•„í•  í™•ë¥ ì´ ë†’ê³  ê·¸ ë°˜ëŒ€ë„ ë§ˆì°¬ê°€ì§€ìž„ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

### Model-based CF

ì‚¬ìš©ìž-ì•„ì´í…œ interaction í–‰ë ¬ì„ í†µí•´ modelì„ í•™ìŠµì‹œí‚¤ëŠ” ë°©ë²•ìž…ë‹ˆë‹¤. í•™ìŠµì‹œí‚¤ê³  ë‚˜ë©´ ì¶”ì²œí•  ë•ŒëŠ” modelë§Œ ìžˆìœ¼ë©´ ë©ë‹ˆë‹¤. ë•Œë¬¸ì— **memory-based**ì— ë¹„í•´ scalabilityì™€ ì¶”ì²œì†ë„ê°€  ë›°ì–´ë‚©ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” Latent Factor Modelì˜ ì¼ì¢…ì¸ Matrix Factorizationì„ ì‚´íŽ´ë³´ê² ìŠµë‹ˆë‹¤.

**Matrix Factorization(í–‰ë ¬ ì¸ìˆ˜ë¶„í•´)**

ë°”ë¡œ ìœ„ì—ì„œ Matrix Factorization(MF)ëŠ” Latent Factor ëª¨ë¸ì˜ ì¼ì¢…ì´ë¼ê³  í–ˆìŠµë‹ˆë‹¤. Latent Factor ëª¨ë¸ì´ í•˜ê³  ì‹¶ì€ ê²ƒì€, ì‚¬ìš©ìžì™€ ì•„ì´í…œì„ ê°ê° 20-100 ì°¨ì› ì •ë„ì˜ vectorë¡œ í‘œí˜„í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì´ ë²¡í„°ëŠ” ê¸°ì¡´ ë°ì´í„°ì—ì„œ ë‚˜íƒ€ë‚˜ëŠ” rating ì •ë³´ë¥¼ ì´ìš©í•´ í•™ìŠµí•©ë‹ˆë‹¤. ì¦‰ ì›ëž˜ ì‚¬ìš©ìž-ì•„ì´í…œ ìƒí˜¸ìž‘ìš© í–‰ë ¬ì„ ì‚¬ìš©ìž, ì•„ì´í…œ ê°ê°ì˜ í–‰ë ¬ë¡œ ìª¼ê°œëŠ”ë°, ê³±í–ˆì„ ë•Œ ìƒí˜¸ìž‘ìš© í–‰ë ¬ì´ ìž˜ ë‚˜íƒ€ë‚˜ì§€ë„ë¡ ê°ê°ì˜ vectorë¥¼ í•™ìŠµì‹œí‚¤ëŠ” ê²ƒì´ ëª©í‘œìž…ë‹ˆë‹¤. **content-based** ë°©ë²•ì—ì„œ ì•„ì´í…œì„ ì œëª©, ìž¥ë¥´, ê°€ìˆ˜ ë“±ìœ¼ë¡œ í‘œí˜„í–ˆë‹¤ë©´ latent factor ëª¨ë¸ì—ì„œëŠ” ìƒí˜¸ìž‘ìš© í–‰ë ¬ì„ í†µí•´ í•™ìŠµëœ, ê¸°ê³„ê°€ ì´í•´í•˜ëŠ” íŠ¹ì§•ë“¤ë¡œ í‘œí˜„í•©ë‹ˆë‹¤. ë•Œë¬¸ì— **content-based**ë³´ë‹¤ í›¨ì”¬ í’ë¶€í•œ ì •ë³´ë¥¼ í‘œí˜„í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

ì‚¬ìš©ìžì™€ ì•„ì´í…œì„ ê°ê° vectorë¡œ ë‚˜íƒ€ë‚¸ë‹¤ê³  í–ˆëŠ”ë°, ì´ ë•Œ ë‘ vectorì˜ ì°¨ì›ì€ ê°™ê²Œ ë§Œë“­ë‹ˆë‹¤. ì•„ëž˜ì˜ ì˜ˆì œëŠ” latent factor ëª¨ë¸ì„ ë‹¨ìˆœí™”ì‹œí‚¨ ê·¸ë¦¼ìž…ë‹ˆë‹¤. xì¶•ì€ ì–‘ì˜ ë°©í–¥ìœ¼ë¡œ ê°ˆìˆ˜ë¡ ë‚¨ì„±ìž„ì„ ì˜ë¯¸í•˜ê³ , yì¶•ì€ ì–‘ì˜ ë°©í–¥ìœ¼ë¡œ ê°ˆìˆ˜ë¡ Seriousí•œ ì •ë„ê°€ ë†’ìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤ : 

![](https://dnddnjs.github.io/assets/img/Untitled-87d5c1c7-f6ef-44a6-ab29-fde9a30d609d.png)

Latent factor ëª¨ë¸ì—ì„œ ì‚¬ìš©ìžì™€ ì•„ì´í…œì˜ latent factorê°€ ê° ì°¨ì›ë§ˆë‹¤ ê°™ì€ ì˜ë¯¸ë¥¼ ê°€ì§€ê³ , ì‚¬ìš©ìžì™€ ì•„ì´í…œ latent factor ë¼ë¦¬ dot-product ê°’ì´ ë†’ìœ¼ë©´ ì¶”ì²œí•˜ëŠ” ë°©ì‹ìž…ë‹ˆë‹¤. ìœ„ ê·¸ë¦¼ì—ì„œëŠ” **Gus**ì—ê²Œ `Dumb and Dumber`ë¥¼ ì¶”ì²œí•˜ê³  `The Color Purple`ì€ ì¶”ì²œí•˜ì§€ ì•Šê² ë„¤ìš”. 

Matrix Factorizationì„ ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ qëŠ” item latent factor matrix ì´ê³  pëŠ” user latent factor matrix ìž…ë‹ˆë‹¤. ì‚¬ìš©ìž uì˜ ì•„ì´í…œ iì— ëŒ€í•œ ratingì„ ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤ : 

![image](https://user-images.githubusercontent.com/51329156/100550029-52d61600-32ba-11eb-81fa-16cd51b7636f.png)

ê·¸ë¦¼ìœ¼ë¡œ ë³´ë©´ ì´í•´ê°€ ì‰½ìŠµë‹ˆë‹¤. MFë¥¼ ì²˜ìŒ ì„¤ëª…í•  ë•Œ ì–¸ê¸‰í•œ ë‚´ìš©ì¸ë°, MFëŠ” ì‚¬ìš©ìž-ì•„ì´í…œ í–‰ë ¬ì„ user latent factor matrixì™€ item latent factor matrixë¡œ ìª¼ê°œëŠ” ê²ƒìž…ë‹ˆë‹¤. ê·¸ë¦¬ê³  ìª¼ê°œì§„ qì™€ p(ì•„ëž˜ ê·¸ë¦¼ì—ì„œëŠ” Uì™€ V)ë¥¼ ê³±í–ˆì„ ë•Œ ì›ëž˜ ì‚¬ìš©ìž-ì•„ì´í…œ í–‰ë ¬ì„ ìž˜ ë§Œë“¤ì–´ë‚´ëŠ” ê²ƒì´ MF í•™ìŠµì˜ í•µì‹¬ìž…ë‹ˆë‹¤.

![](https://buildingrecommenders.files.wordpress.com/2015/11/matrix-factorisation.png?w=900)

MFì˜ objective functionì€ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ëª©í‘œëŠ” ì›ëž˜ ratingì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒìœ¼ë¡œ, lossëŠ” MSE lossë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì•„ëž˜ ì‹ì—ì„œ KëŠ” ratingì´ ì•Œë ¤ì§„ ì‚¬ìš©ìž-ì•„ì´í…œ ìŒì„ ë§í•©ë‹ˆë‹¤. ìœ„ ê·¸ë¦¼ì—ì„œëŠ” ë…¸ëž€ìƒ‰ í‘œì‹œê°€ ëœ ê²½ìš°ë¥¼ ì–˜ê¸°í•©ë‹ˆë‹¤. ì´ ë•Œ MSE lossë§Œ ìµœì†Œê°€ ë˜ê²Œ í•™ìŠµì‹œí‚¤ë©´ ë˜ê² ë‹¤ê³  ìƒê°í•  ìˆ˜ ìžˆì§€ë§Œ, ê·¸ëŸ¬ë©´ overfittingì´ ë°œìƒí•˜ê²Œ ë©ë‹ˆë‹¤. ê·¸ëž˜ì„œ **L2 regularization**ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. **L2 regularization**ì€ overfittingì„ ë§‰ê¸° ìœ„í•´ cost functionì— ê°€ì¤‘ì¹˜ì˜ ì œê³±ì„ ë”í•˜ë©´ì„œ í•™ìŠµí•˜ëŠ” ë°©ì‹ìž…ë‹ˆë‹¤. 

![image](https://user-images.githubusercontent.com/51329156/100550370-edcfef80-32bc-11eb-90c5-6757f62afe85.png)

ìœ„ objective functionì„ ìµœì†Œí™”í•˜ëŠ” pì™€ që¥¼ ì°¾ëŠ” ê²ƒì´ ëª©ì ì´ê³ , ì´ë¥¼ ìœ„í•œ ë°©ë²•ì€ ìƒëžµí•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

### Deep Learning Meets CF

**Methods of Representation Learning(í‘œí˜„ í•™ìŠµ)**

 DNNì´ ë†’ì€ ì„±ëŠ¥ì„ ë‚´ëŠ” ë°°ê²½ì—ëŠ” ë³µìž¡í•œ ë°ì´í„° ê³µê°„ì„ ì„ í˜• ë¶„ë¥˜ê°€ ê°€ëŠ¥í•  ì •ë„ë¡œ ë‹¨ìˆœí™”í•´ í‘œí˜„í•˜ê¸° ë•Œë¬¸ì´ë¼ëŠ” ì´ë¡ ì´ ìžˆìŠµë‹ˆë‹¤. **í‘œí˜„í•™ìŠµ**ì€ íŠ¹ì • taskë¥¼ ìˆ˜í–‰í•˜ê¸°ì— ì¢‹ì€ í‘œí˜„ì„ ë§Œë“œëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì•„ëž˜ ê·¸ë¦¼ì—ì„œëŠ” Matrix Factorizationê³¼ í‘œí˜„í•™ìŠµì„ ì‚¬ìš©í•œ ê²ƒì„ ì„¤ëª…í•˜ê³  ìžˆìŠµë‹ˆë‹¤ :

![image](https://user-images.githubusercontent.com/51329156/101655831-684efb00-3a85-11eb-9dd3-4963d047d482.png)

ìœ ì € Rowì— ëŒ€í•´ DNNì„ ì‚¬ìš©í•´ Representationì„ ì–»ê³ , ì•„ì´í…œ Columnì— ëŒ€í•´ì„œë„ ë§ˆì°¬ê°€ì§€ë¡œ Representationì„ ì–»ìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ê·¸ ì–»ì€ ë‘ í‘œí˜„ì„ ì´ìš©í•´ Scoreë¥¼ ì–»ìŠµë‹ˆë‹¤. ì´ ê°’ì´ ë†’ìœ¼ë©´ User iê°€ Item jë¥¼ ì¢‹ì•„í•œë‹¤ê³  íŒë‹¨í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. Representationì„ ì–»ëŠ”ë‹¤ëŠ” ê²Œ ë³„ ë‹¤ë¥¸ ê²Œ ì•„ë‹™ë‹ˆë‹¤. MNIST ì´ë¯¸ì§€ë¥¼ ë°›ì•„ì„œ 0~9 ì‚¬ì´ì˜ ìˆ«ìž ì¤‘ ë¬´ì—‡ì¸ì§€ íŒë³„í•˜ëŠ” ë¬¸ì œë¥¼ í’€ ë•Œ MNIST ì´ë¯¸ì§€ë¥¼ ì—¬ëŸ¬ Layerë¥¼ ê±°ì³ 10ì°¨ì›ì˜  ë°ì´í„°ë¡œ í‘œí˜„í•©ë‹ˆë‹¤. ì´ ê³¼ì •ë„ ë§ˆì°¬ê°€ì§€ë¡œ **Representation Learning**ì´ë¼ê³  í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 


### Updating ... 

> Reference
>
> ðŸš€ [https://next-nus.github.io/slides/tuto-cikm2019-public.pdf](https://next-nus.github.io/slides/tuto-cikm2019-public.pdf)
>
> ðŸš€ [í˜‘ì—… í•„í„°ë§ ì¶”ì²œ ì‹œìŠ¤í…œ (Collaborative Filtering Recommendation System)](https://scvgoe.github.io/2017-02-01-%ED%98%91%EC%97%85-%ED%95%84%ED%84%B0%EB%A7%81-%EC%B6%94%EC%B2%9C-%EC%8B%9C%EC%8A%A4%ED%85%9C-(Collaborative-Filtering-Recommendation-System)/)
>
> ðŸš€ [ì¶”ì²œ ì‹œìŠ¤í…œ Basics](https://dnddnjs.github.io/recomm/2019/08/15/recommendation_system_basics/)
>
> ðŸš€ [https://datajobs.com/data-science-repo/Recommender-Systems-[Netflix].pdf](https://datajobs.com/data-science-repo/Recommender-Systems-[Netflix].pdf)
>
> ðŸš€ [Overview of Recommender Algorithms â€“ Part 2](https://buildingrecommenders.wordpress.com/2015/11/18/overview-of-recommender-algorithms-part-2/)

 

